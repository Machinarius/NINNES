\documentclass[10pt]{beamer}

\usetheme[progressbar=frametitle]{metropolis}
\usepackage{appendixnumberbeamer}

\usepackage{tikz}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}

\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\usepackage{caption}
\usepackage{subcaption}
\captionsetup{labelformat=empty}

\title{NINNES}
\subtitle{dotNet and Roslyn behind the Curtains}
% \date{\today}
\date{November 8, 2018}
\author{Germán Valencia - @XMachinarius}
\institute{Growth Acceleration Partners}
\titlegraphic{\hfill\includegraphics[height=1.5cm]{img/gap_logo.png}}
\logo{\includegraphics[height=1.5cm]{img/gap_logo.png}}
\begin{document}

\maketitle

\begin{frame}{Table of contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}

\section{Introduction}
\begin{frame}{What are we here for?}
    \begin{itemize}
        \item NINNES project
        \item dotNet compilation and execution internals
        \item Roslyn internals
        \item Cool demo
    \end{itemize}
\end{frame}

\begin{frame}{NINNES Project}
    \begin{enumerate}
        \item Bringing C\# into NES game programming
        \item Customizing the dotNet compilation process
        \item Programming CPU-equivalent libraries
    \end{enumerate}
\end{frame}

\begin{frame}{C\# Code Tailoring}
    \begin{figure}
        \centering
        \includegraphics[height=190pt]{img/scissors.jpg}
        \caption{Cutting C\# down to size \\ \tiny{\href{Photo by Pixabay, taken from Pexels}{https://www.pexels.com/photo/fabric-scissors-needle-needles-scissors-461035/}}}
    \end{figure}
\end{frame}

\begin{frame}{NES dotNet Shims Platform}
    \begin{figure}
        \centering
        \includegraphics[width=\textwidth]{img/bridge.jpg}
        \caption{Bridging the gap to the unknown \\ \tiny{\href{Photo by Nikolai Ulltang from Pexels}{https://www.pexels.com/photo/architecture-bridge-fog-ocean-285283/}}}
    \end{figure}
\end{frame}

\begin{frame}{C\# Compilation to the NES CPU}
    \begin{figure}
        \centering
        \includegraphics[width=160pt]{img/cardmaster.jpg}
        \caption{One Ace up the sleeve. \\ \tiny{\href{Photo by Nikolai Ivanov from Pexels}{https://www.pexels.com/photo/actor-adult-business-cards-547593/}}}
    \end{figure}
\end{frame}

\begin{frame}{Why?}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/1337.png}
        \caption{Showcasing dotNet's flexibility \\ \tiny{And 1337 internet points}}
    \end{figure}
\end{frame}

\section{From Visual Studio to F5, dotNet behind the curtains}
\begin{frame}{The Show Begins}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/curtains.jpg}
        \caption{From idea to execution, a play by Microsoft \\ \tiny{\href{Photo by Monica Silvestre from Pexels}{https://www.pexels.com/photo/people-at-theater-713149/}}}
    \end{figure}
\end{frame}

\begin{frame}{C\#, the Typewriter}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/Typewriter.jpg}
        \caption{Just another day in Heaven \\ \tiny{\href{Photo by rawpixel.com from Pexels}{https://www.pexels.com/photo/person-using-typewriter-on-white-surfac-886470/}}}
    \end{figure}
\end{frame}

\begin{frame}{BCL, the Acting Academy}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/Books.jpg}
        \caption{Theory and Practice of the OS and CPU \\ \tiny{\href{Photo by Pixabay from Pexels}{https://www.pexels.com/photo/pile-of-books-159866/}}}
    \end{figure}
\end{frame}

\begin{frame}{Roslyn, Costumer Extraordinaire}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/TailorSuit.jpg}
        \caption{Making sure Actors are properly dressed \\ \tiny{\href{Photo by rawpixel.com from Pexels}{https://www.pexels.com/photo/tailor-measuring-man-s-chest-1282309/}}}
    \end{figure}
\end{frame}

\begin{frame}{MSIL, the Script}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/PaperOnTypewriter.jpg}
        \caption{Business Value, one OpCode at a time \\ \tiny{\href{Photo by rawpixel.com from Pexels}{https://www.pexels.com/photo/paper-attached-to-typewriter-921780/}}}
    \end{figure}    
\end{frame}

\begin{frame}{MSBuild, the Producer}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/TakingNotes.jpg}
        \caption{Keeping track of everything \\ \tiny{\href{Photo by Startup Stock Photos from Pexels}{https://www.pexels.com/photo/man-desk-notebook-office-7060/}}}
    \end{figure}
\end{frame}

\begin{frame}{RyuJIT, the Director}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/Director.jpg}
        \caption{Making sure everything is on rails \\ \tiny{\href{Photo by Pixabay from Pexels}{https://www.pexels.com/photo/acting-action-actor-actress-275200/}}}
    \end{figure}
\end{frame}

\begin{frame}{CLI, the Stage}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/Theater.jpg}
        \caption{Solid ground to stand on \\ \tiny{\href{Photo by Donald Tong from Pexels}{https://www.pexels.com/photo/architecture-room-indoors-auditorium-109669/}}}
    \end{figure}
\end{frame}

\begin{frame}{dotNet Native, the Cameraman}
    \begin{figure}
        \centering
        \includegraphics[width=250pt]{img/Camera.jpg}
        \caption{Recording from all angles \\ \tiny{\href{Photo by Donald Tong from Pexels}{https://www.pexels.com/photo/camera-event-live-settings-66134/}}}
    \end{figure}
\end{frame}

\section{From Visual Studio to the NES}
\begin{frame}{The Limits of the NES}
The NES runs on a MOS6502 8-bit CPU implementation from Ricoh, albeit without the decimal/floating point mode enabled. This brings forth several limitations:
\begin{itemize}
    \item No floating point calculations
    \item No multiplication or division implemented in hardware
    \item No Operating System
    \item Limited memory access capabilities
\end{itemize}
\end{frame}

\begin{frame}{Removing dotNet from C\#, 8 bits at a time}
To be able to fit a C\# program inside the NES some concessions must be made, including:
\begin{itemize}
    \item No Garbage Collection
    \item No Threading
    \item No Operating System services
    \item No DLR
    \item No Reflection
    \item No Sockets/Communication
\end{itemize}
\end{frame}

\begin{frame}{MSIL and 8-bit CPUs don't mix}
Bringing C\# compilation output to a MOS6502-compatible format may entail
\begin{itemize}
    \item Direct ASM transpilation from Roslyn C\# ASTs
    \item C++ transpilation from Roslyn C\# ASTs for compilation with a MOS6502-compatible compiler
    \item MSIL recompilation with LLILC
    \item Researching the work of the .Net Micro Framework
\end{itemize}
\end{frame}

\section{Roslyn is a Friend, not an Enemy}
\begin{frame}{General Roslyn Services}
    \begin{figure}
        \center
        \includegraphics[width=250pt]{img/RoslynServices.png}
        \caption{Some of the services exposed by Roslyn \\ \tiny{\href{Taken from DotNetCurry}{https://www.dotnetcurry.com/csharp/1258/dotnet-platform-compiler-roslyn-overview}}}
    \end{figure}
\end{frame}

\begin{frame}{Compiler basics - What is code?}
English is the language of the human, Assembler OpCodes is the language of the machine. Compilers must act as a bridge in between these two realms of knowledge, and they too have their own abstraction: The Abstract Syntax Tree.
\end{frame}

\begin{frame}[fragile]{Compiler basics - Code Sample}
\begin{verbatim}
var x = 2;
var y = 3;
x *= y;
\end{verbatim}
\end{frame}

\begin{frame}{Compiler basics - Abstract Syntax Tree}
    \begin{figure}
        \center
        \includegraphics[width=\textwidth]{img/RoslynASTSample.png}
        \caption{A basic Roslyn AST \\ \tiny{Own work}}
    \end{figure}
\end{frame}

\begin{frame}{Roslyn Code Model}
Roslyn Design Goals:

\begin{block}{Speed}
    Analysis must be performed incrementally and in real time
\end{block}

\begin{block}{Memory Economy}
    Visual Studio can already be daunting for some machines
\end{block}
\end{frame}

\begin{frame}{Roslyn Basics - Code Diagnostics}
Two words: CUSTOM SQUIGGLIES
\end{frame}

\section{DEMO}

\begin{frame}{Thank you!}
\begin{block}{Germán Valencia}
    @XMachinarius \\ Growth Acceleration Partners
\end{block}
\end{frame}

{ % Source: https://tex.stackexchange.com/questions/3915/image-on-full-slide-in-beamer-package
    \setbeamertemplate{navigation symbols}{}
    \begin{frame}[plain]
        \begin{tikzpicture}[remember picture,overlay]
            \node[at=(current page.center)] {
                \includegraphics[width=\paperwidth]{img/NetConfOutroBackground.jpg}
            };
        \end{tikzpicture}
     \end{frame}
}
\end{document}
